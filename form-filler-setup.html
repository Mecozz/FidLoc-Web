<!DOCTYPE html>
<html>
<head>
  <title>FidLoc Form Filler - Test Page</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #1a1a2e;
      color: #eee;
    }
    h1 { color: #4ecdc4; }
    h2 { color: #45b7aa; margin-top: 30px; }
    .bookmarklet-link {
      display: inline-block;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px 30px;
      border-radius: 10px;
      text-decoration: none;
      font-weight: bold;
      font-size: 18px;
      margin: 20px 0;
      cursor: move;
    }
    .bookmarklet-link:hover {
      transform: scale(1.05);
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
    }
    .code-box {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 15px;
      overflow-x: auto;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      line-height: 1.5;
      color: #c9d1d9;
      margin: 15px 0;
      word-break: break-all;
    }
    .step {
      background: #16213e;
      border-left: 4px solid #4ecdc4;
      padding: 15px 20px;
      margin: 15px 0;
      border-radius: 0 8px 8px 0;
    }
    .step-number {
      display: inline-block;
      background: #4ecdc4;
      color: #1a1a2e;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      text-align: center;
      line-height: 30px;
      font-weight: bold;
      margin-right: 10px;
    }
    .test-section {
      background: #16213e;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }
    button {
      background: #4ecdc4;
      color: #1a1a2e;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #45b7aa;
    }
    .copy-btn {
      background: #667eea;
      color: white;
    }
    #testOutput {
      background: #0d1117;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      min-height: 100px;
      font-family: monospace;
      white-space: pre-wrap;
    }
    a { color: #4ecdc4; }
  </style>
</head>
<body>
  <h1>üöÄ FidLoc Form Auto-Filler</h1>
  <p>Auto-fill Microsoft Forms for inventory submissions</p>

  <h2>üì± Installation</h2>
  
  <div class="step">
    <span class="step-number">1</span>
    <strong>Desktop (Chrome/Safari):</strong> Drag this button to your bookmarks bar:
    <br><br>
    <a class="bookmarklet-link" href="javascript:(async()=>{const C={name:'Darren Couturier',garage:'Concord',status:'Missing',ids:{n:'rda892478c0b741ecb670fda088fcbc7b',g:'r8076010f6735476abb0af5bfb040117e',s:'rfa582ebfb11e40f3bf00d8e0a9efbe9c',e:'r4eb635e098d24e8a8de3ed2331979cdb'}};function setV(i,v){if(!i)return!1;const s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,'value').set;s.call(i,v);i.dispatchEvent(new Event('input',{bubbles:!0}));i.dispatchEvent(new Event('change',{bubbles:!0}));return!0}function find(id){let e=document.querySelector(`input[aria-labelledby*='${id}']`);if(e)return e;e=document.querySelector(`textarea[aria-labelledby*='${id}']`);return e}function radio(v){const r=document.querySelectorAll('[role=radio]');for(const x of r){if((x.textContent||'').includes(v)){x.click();return!0}}return!1}let serial;try{serial=await navigator.clipboard.readText();if(!serial||!confirm(`Use: '${serial}'?`))serial=prompt('Serial:')}catch{serial=prompt('Serial:')}if(!serial){alert('Cancelled');return}let f=0;if(setV(find(C.ids.n),C.name))f++;await new Promise(r=>setTimeout(r,50));if(setV(find(C.ids.g),C.garage))f++;await new Promise(r=>setTimeout(r,50));if(setV(find(C.ids.s),serial))f++;await new Promise(r=>setTimeout(r,50));if(radio(C.status))f++;alert(f>=3?`‚úÖ Filled!\n\nSerial: ${serial}\n\nTap Submit!`:`‚ö†Ô∏è ${f}/4 filled`)})();">üìù Fill Form</a>
  </div>

  <div class="step">
    <span class="step-number">2</span>
    <strong>iPhone/iPad:</strong> Copy the code below, create a bookmark, edit it, and paste as the URL
  </div>

  <h2>üìã Bookmarklet Code</h2>
  <p>Copy this entire code (click the button):</p>
  
  <div class="code-box" id="bookmarkletCode">javascript:(async()=>{const C={name:'Darren Couturier',garage:'Concord',status:'Missing',ids:{n:'rda892478c0b741ecb670fda088fcbc7b',g:'r8076010f6735476abb0af5bfb040117e',s:'rfa582ebfb11e40f3bf00d8e0a9efbe9c',e:'r4eb635e098d24e8a8de3ed2331979cdb'}};function setV(i,v){if(!i)return!1;const s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,'value').set;s.call(i,v);i.dispatchEvent(new Event('input',{bubbles:!0}));i.dispatchEvent(new Event('change',{bubbles:!0}));return!0}function find(id){let e=document.querySelector(`input[aria-labelledby*='${id}']`);if(e)return e;e=document.querySelector(`textarea[aria-labelledby*='${id}']`);return e}function radio(v){const r=document.querySelectorAll('[role=radio]');for(const x of r){if((x.textContent||'').includes(v)){x.click();return!0}}return!1}let serial;try{serial=await navigator.clipboard.readText();if(!serial||!confirm(`Use: '${serial}'?`))serial=prompt('Serial:')}catch{serial=prompt('Serial:')}if(!serial){alert('Cancelled');return}let f=0;if(setV(find(C.ids.n),C.name))f++;await new Promise(r=>setTimeout(r,50));if(setV(find(C.ids.g),C.garage))f++;await new Promise(r=>setTimeout(r,50));if(setV(find(C.ids.s),serial))f++;await new Promise(r=>setTimeout(r,50));if(radio(C.status))f++;alert(f>=3?`‚úÖ Filled!\n\nSerial: ${serial}\n\nTap Submit!`:`‚ö†Ô∏è ${f}/4 filled`)})();</div>
  
  <button class="copy-btn" onclick="copyCode()">üìã Copy Code</button>

  <h2>üß™ Test It Now</h2>
  <div class="test-section">
    <p>Open the Microsoft Form, then click the bookmarklet above (or copy/paste into console):</p>
    <a href="https://forms.office.com/pages/responsepage.aspx?id=XZI8ME5OQUqmnyZJVrSH1lwcfjB4TM5Dqw11fNLOPYxUMVNQSjU1QjhXV1dLSzZZUTdJOFhGVTRQSS4u" target="_blank">
      <button>üîó Open Microsoft Form (new tab)</button>
    </a>
    <br><br>
    <p><strong>Steps:</strong></p>
    <ol>
      <li>Click the button above to open the form</li>
      <li>Click the "Fill Form" bookmarklet (or paste code in console)</li>
      <li>Enter a test serial number when prompted</li>
      <li>Watch the form fill automatically!</li>
    </ol>
  </div>

  <h2>‚öôÔ∏è Configuration</h2>
  <p>The bookmarklet is configured with:</p>
  <ul>
    <li><strong>Technician Name:</strong> Darren Couturier</li>
    <li><strong>Garage:</strong> Concord</li>
    <li><strong>Status:</strong> Missing (auto-selected)</li>
  </ul>
  <p>To change these, edit the values in the bookmarklet code where you see <code>name:'Darren Couturier'</code> etc.</p>

  <h2>üì± iPhone Setup (Detailed)</h2>
  <div class="step">
    <span class="step-number">1</span>
    Open Safari and bookmark this page (or any page)
  </div>
  <div class="step">
    <span class="step-number">2</span>
    Go to Bookmarks (book icon at bottom)
  </div>
  <div class="step">
    <span class="step-number">3</span>
    Tap "Edit" in the bottom right
  </div>
  <div class="step">
    <span class="step-number">4</span>
    Find and tap the bookmark you just made
  </div>
  <div class="step">
    <span class="step-number">5</span>
    Change the name to "Fill Form"
  </div>
  <div class="step">
    <span class="step-number">6</span>
    Tap the URL field, select all, delete it
  </div>
  <div class="step">
    <span class="step-number">7</span>
    Paste the bookmarklet code (copied above)
  </div>
  <div class="step">
    <span class="step-number">8</span>
    Tap "Done" to save
  </div>

  <script>
    function copyCode() {
      const code = document.getElementById('bookmarkletCode').textContent;
      navigator.clipboard.writeText(code).then(() => {
        alert('‚úÖ Code copied to clipboard!');
      }).catch(() => {
        // Fallback for older browsers
        const textarea = document.createElement('textarea');
        textarea.value = code;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        alert('‚úÖ Code copied to clipboard!');
      });
    }
  </script>
</body>
</html>
